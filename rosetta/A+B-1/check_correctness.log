clang -Xclang -disable-O0-optnone -S -emit-llvm -g a+b-1.c
opt -loop-simplify a+b-1.ll -S -o a+b-1.ll
opt -mem2reg a+b-1.ll -S -o a+b-1_mem2reg.ll
llvm-cbe a+b-1_mem2reg.ll
clang -g -O3 a+b-1_mem2reg.cbe.c -lm -o a+b-1_mem2reg.cbe.exe
a+b-1_mem2reg.cbe.c:42:10: warning: incompatible redeclaration of library function 'printf' [-Wincompatible-library-redeclaration]
uint32_t printf(uint8_t*, ...);
         ^
a+b-1_mem2reg.cbe.c:42:10: note: 'printf' is a builtin with type 'int (const char *, ...)'
1 warning generated.
opt a+b-1.ll -o a+b-1.bc
llvm-cbe a+b-1.bc
llvm-dis a+b-1.bc #just for debugging
clang -g -O3 a+b-1.cbe.c -lm -o a+b-1.cbe.exe
a+b-1.cbe.c:42:10: warning: incompatible redeclaration of library function 'printf' [-Wincompatible-library-redeclaration]
uint32_t printf(uint8_t*, ...);
         ^
a+b-1.cbe.c:42:10: note: 'printf' is a builtin with type 'int (const char *, ...)'
1 warning generated.
llc -filetype=obj a+b-1.ll -o a+b-1.o
clang -g -O3 -lm a+b-1.o -o a+b-1.exe
./a+b-1.exe > a+b-1.out
./a+b-1.cbe.exe > a+b-1.cbe.out
./a+b-1_mem2reg.cbe.exe > a+b-1_mem2reg.cbe.out
diff a+b-1.out a+b-1.cbe.out
1c1
< 0
---
> 4198720
make: *** [../Makefile.generic:30: check_correctness] Error 1
