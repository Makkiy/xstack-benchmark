clang -Xclang -disable-O0-optnone -S -emit-llvm -g search-a-list.c
opt -loop-simplify search-a-list.ll -S -o search-a-list.ll
opt -mem2reg search-a-list.ll -S -o search-a-list_mem2reg.ll
llvm-cbe search-a-list_mem2reg.ll
SUSAN: print loop:Loop at depth 1 containing: %while.cond<header><exiting>,%while.body<exiting>,%if.end<latch>

SUSAN: exit block:
while.end:                                        ; preds = %while.cond
  br label %return, !dbg !40

SUSAN: exit block:
if.then:                                          ; preds = %while.body
  br label %return, !dbg !36

SUSAN: irregular exit:   br label %return, !dbg !36
SUSAN: print loop:Loop at depth 1 containing: %while.cond<header><exiting>,%while.body,%if.then6,%if.end7<latch>

SUSAN: exit block:
while.end:                                        ; preds = %while.cond
  br label %return, !dbg !47

clang -g -O3 search-a-list_mem2reg.cbe.c -lm -o search-a-list_mem2reg.cbe.exe
search-a-list_mem2reg.cbe.c:74:10: warning: incompatible redeclaration of library function 'strcmp' [-Wincompatible-library-redeclaration]
uint32_t strcmp(uint8_t*, uint8_t*) __ATTRIBUTELIST__((nothrow, pure));
         ^
search-a-list_mem2reg.cbe.c:74:10: note: 'strcmp' is a builtin with type 'int (const char *, const char *)'
search-a-list_mem2reg.cbe.c:77:10: warning: incompatible redeclaration of library function 'printf' [-Wincompatible-library-redeclaration]
uint32_t printf(uint8_t*, ...);
         ^
search-a-list_mem2reg.cbe.c:77:10: note: 'printf' is a builtin with type 'int (const char *, ...)'
2 warnings generated.
opt search-a-list.ll -o search-a-list.bc
llvm-cbe search-a-list.bc
SUSAN: print loop:Loop at depth 1 containing: %while.cond<header><exiting>,%while.body<exiting>,%if.end<latch>

SUSAN: exit block:
while.end:                                        ; preds = %while.cond
  store i32 -1, i32* %retval, align 4, !dbg !46
  br label %return, !dbg !46

SUSAN: exit block:
if.then:                                          ; preds = %while.body
  %7 = load i32, i32* %i, align 4, !dbg !41
  store i32 %7, i32* %retval, align 4, !dbg !42
  br label %return, !dbg !42

SUSAN: irregular exit:   br label %return, !dbg !42
SUSAN: print loop:Loop at depth 1 containing: %while.cond<header><exiting>,%while.body,%if.then6,%if.end7<latch>

SUSAN: exit block:
while.end:                                        ; preds = %while.cond
  %11 = load i32, i32* %last, align 4, !dbg !59
  store i32 %11, i32* %retval, align 4, !dbg !60
  br label %return, !dbg !60

llvm-dis search-a-list.bc #just for debugging
clang -g -O3 search-a-list.cbe.c -lm -o search-a-list.cbe.exe
search-a-list.cbe.c:74:10: warning: incompatible redeclaration of library function 'strcmp' [-Wincompatible-library-redeclaration]
uint32_t strcmp(uint8_t*, uint8_t*) __ATTRIBUTELIST__((nothrow, pure));
         ^
search-a-list.cbe.c:74:10: note: 'strcmp' is a builtin with type 'int (const char *, const char *)'
search-a-list.cbe.c:77:10: warning: incompatible redeclaration of library function 'printf' [-Wincompatible-library-redeclaration]
uint32_t printf(uint8_t*, ...);
         ^
search-a-list.cbe.c:77:10: note: 'printf' is a builtin with type 'int (const char *, ...)'
2 warnings generated.
llc -filetype=obj search-a-list.ll -o search-a-list.o
clang -g -O3 -lm search-a-list.o -o search-a-list.exe
./search-a-list.exe > search-a-list.out
./search-a-list.cbe.exe > search-a-list.cbe.out
./search-a-list_mem2reg.cbe.exe > search-a-list_mem2reg.cbe.out
diff search-a-list.out search-a-list.cbe.out
diff search-a-list.out search-a-list_mem2reg.cbe.out
